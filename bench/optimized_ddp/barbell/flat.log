Arguments: Namespace(mode='flat', world_size=2, local_batch_size=4, context_length=128, verbose=True, ckpt_dir='../bench/optimized_ddp/barbell/ckpt', bucket_size_mb=10)
=== Rank 1 Results ===
(Rank 1) Iteration times (ms): [709.8878173828125, 707.4789428710938, 709.4415283203125, 710.7979125976562, 710.2213745117188]
(Rank 1) Gradient communication times (ms): [114.86835479736328, 111.50335693359375, 113.58850860595703, 115.2573471069336, 115.16722869873047]
(Rank 1) Iteration time avg (std): 709.57 (1.13) ms
(Rank 1) Gradient communication time avg (std): 114.08 (1.42) ms
(Rank 1) Fraction of gradient communication time in an iteration: 16.08%
=== Rank 1 Extra Stats ===
{
    "warmup_iteration_times": [
        1248.2457275390625,
        709.65625
    ],
    "warmup_communication_times": [
        111.78598022460938,
        113.82147216796875
    ],
    "warmup_copy_times": [
        15.112192153930664,
        14.887104034423828
    ],
    "copy_times": [
        14.845791816711426,
        14.856575965881348,
        14.833663940429688,
        14.846976280212402,
        14.84118366241455
    ],
    "copy_time_avg": 14.844838333129882,
    "copy_time_std": 0.00750300795057382,
    "copy_time_pct": 2.0921088079426617,
    "total_communication_volume_in_bytes": 4289879040.0,
    "communication_throughputs_in_bytes_per_second": [
        37346047547.800964,
        38473093169.337074,
        37766840084.869484,
        37220005038.11641,
        37249129708.78224
    ],
    "avg_communication_throughput_in_gbps": 35.027994876523714,
    "std_communication_throughput_in_gbps": 0.4410808472485822
}
Mode: flat
=== Rank 0 Results ===
(Rank 0) Iteration times (ms): [709.865478515625, 707.4319458007812, 709.4371337890625, 710.7745361328125, 710.2935180664062]
(Rank 0) Gradient communication times (ms): [112.389404296875, 112.4788818359375, 111.62115478515625, 112.42857360839844, 112.0552978515625]
(Rank 0) Iteration time avg (std): 709.56 (1.15) ms
(Rank 0) Gradient communication time avg (std): 112.19 (0.32) ms
(Rank 0) Fraction of gradient communication time in an iteration: 15.81%
=== Rank 0 Extra Stats ===
{
    "warmup_iteration_times": [
        1248.5853271484375,
        709.7098388671875
    ],
    "warmup_communication_times": [
        129.18019104003906,
        112.10546875
    ],
    "warmup_copy_times": [
        15.037759780883789,
        14.891807556152344
    ],
    "copy_times": [
        14.856127738952637,
        14.835391998291016,
        14.847071647644043,
        14.856703758239746,
        14.855520248413086
    ],
    "copy_time_avg": 14.850163078308105,
    "copy_time_std": 0.008182893015654788,
    "copy_time_pct": 2.0928714395953802,
    "total_communication_volume_in_bytes": 4289879040.0,
    "communication_throughputs_in_bytes_per_second": [
        38169781812.067856,
        38139417550.90745,
        38432491119.241516,
        38156483732.882164,
        38283589640.56051
    ],
    "avg_communication_throughput_in_gbps": 35.61037850671625,
    "std_communication_throughput_in_gbps": 0.10279098532679877
}
