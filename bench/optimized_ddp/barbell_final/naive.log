Arguments: Namespace(mode='naive', world_size=2, local_batch_size=4, context_length=128, verbose=True, ckpt_dir=None, bucket_size_mb=10)
Mode: naive
=== Rank 0 Results ===
(Rank 0) Iteration times (ms): [710.8675537109375, 712.0732421875, 711.122802734375, 711.3863525390625, 712.1102294921875]
(Rank 0) Gradient communication times (ms): [130.61325073242188, 130.6395263671875, 131.83030700683594, 130.72793579101562, 130.9141387939453]
(Rank 0) Iteration time avg (std): 711.51 (0.50) ms
(Rank 0) Gradient communication time avg (std): 130.95 (0.46) ms
(Rank 0) Fraction of gradient communication time in an iteration: 18.40%
=== Rank 0 Extra Stats ===
{
    "warmup_iteration_times": [
        1228.888916015625,
        712.591064453125,
        711.7680053710938
    ],
    "warmup_communication_times": [
        129.72227478027344,
        130.65731811523438,
        130.53021240234375
    ],
    "warmup_zero_grad_times": [
        0.36320000886917114,
        1.2422080039978027,
        0.9564160108566284
    ],
    "zero_grad_times": [
        0.9448000192642212,
        0.9461759924888611,
        0.9369919896125793,
        0.9850879907608032,
        0.9544320106506348
    ],
    "zero_grad_time_avg": 0.9534976005554199,
    "zero_grad_time_std": 0.016736277561920063,
    "zero_grad_time_pct": 0.13400993298853023,
    "warmup_fwd_times": [
        530.8804931640625,
        105.25100708007812,
        104.49715423583984
    ],
    "fwd_times": [
        104.185791015625,
        104.65074920654297,
        102.6220474243164,
        104.44390106201172,
        104.353759765625
    ],
    "fwd_time_avg": 104.05124969482422,
    "fwd_time_std": 0.7301791014085012,
    "fwd_time_pct": 14.623932204806087,
    "warmup_loss_times": [
        6.006783962249756,
        1.0389440059661865,
        1.0383360385894775
    ],
    "loss_times": [
        1.0396480560302734,
        1.0382399559020996,
        1.0383360385894775,
        1.0382399559020996,
        1.038591980934143
    ],
    "loss_time_avg": 1.0386111974716186,
    "loss_time_std": 0.0005341905956243149,
    "loss_time_pct": 0.14597250170530487,
    "warmup_bwd_times": [
        299.72216796875,
        226.6174774169922,
        227.05059814453125
    ],
    "bwd_times": [
        226.36618041992188,
        227.08848571777344,
        227.0714569091797,
        226.58058166503906,
        227.1903076171875
    ],
    "bwd_time_avg": 226.85940246582032,
    "bwd_time_std": 0.3249472166317947,
    "bwd_time_pct": 31.884119407755797,
    "warmup_step_times": [
        262.19390869140625,
        247.7841033935547,
        247.69532775878906
    ],
    "step_times": [
        247.7178955078125,
        247.71005249023438,
        247.62367248535156,
        247.610595703125,
        247.6590118408203
    ],
    "step_time_avg": 247.66424560546875,
    "step_time_std": 0.04365424401672312,
    "step_time_pct": 34.80817651784163,
    "total_communication_volume_in_bytes": 4289879040.0,
    "communication_throughputs_in_bytes_per_second": [
        32844133469.95223,
        32837527502.5299,
        32540916708.76222,
        32815319954.702633,
        32768645766.76575
    ],
    "avg_communication_throughput_in_gbps": 30.511346348135312,
    "std_communication_throughput_in_gbps": 0.10554225259151803
}
=== Rank 1 Results ===
(Rank 1) Iteration times (ms): [710.7499389648438, 712.0607299804688, 711.235595703125, 711.3670654296875, 712.0750122070312]
(Rank 1) Gradient communication times (ms): [138.3057861328125, 131.9956512451172, 130.74815368652344, 130.45053100585938, 131.6556854248047]
(Rank 1) Iteration time avg (std): 711.50 (0.51) ms
(Rank 1) Gradient communication time avg (std): 132.63 (2.89) ms
(Rank 1) Fraction of gradient communication time in an iteration: 18.64%
=== Rank 1 Extra Stats ===
{
    "warmup_iteration_times": [
        1228.8856201171875,
        712.6453247070312,
        711.81689453125
    ],
    "warmup_communication_times": [
        145.59706115722656,
        132.8844757080078,
        131.42425537109375
    ],
    "warmup_zero_grad_times": [
        0.3702079951763153,
        1.1783039569854736,
        0.971776008605957
    ],
    "zero_grad_times": [
        1.0131200551986694,
        0.967199981212616,
        0.9662399888038635,
        0.969215989112854,
        0.9830399751663208
    ],
    "zero_grad_time_avg": 0.9797631978988648,
    "zero_grad_time_std": 0.01775033751278277,
    "zero_grad_time_pct": 0.13770541111214565,
    "warmup_fwd_times": [
        531.9111328125,
        104.16480255126953,
        104.43059539794922
    ],
    "fwd_times": [
        99.32982635498047,
        104.21043395996094,
        104.41939544677734,
        104.87117004394531,
        104.34969329833984
    ],
    "fwd_time_avg": 103.43610382080078,
    "fwd_time_std": 2.0650435835938916,
    "fwd_time_pct": 14.537664971553236,
    "warmup_loss_times": [
        5.853184223175049,
        1.0383039712905884,
        1.0381120443344116
    ],
    "loss_times": [
        1.039199948310852,
        1.0383360385894775,
        1.037984013557434,
        1.0382720232009888,
        1.0383360385894775
    ],
    "loss_time_avg": 1.038425612449646,
    "loss_time_std": 0.00040847086008834465,
    "loss_time_pct": 0.1459493605288261,
    "warmup_bwd_times": [
        282.9756164550781,
        225.5816650390625,
        226.19158935546875
    ],
    "bwd_times": [
        223.39353942871094,
        226.19955444335938,
        226.4132537841797,
        226.3968963623047,
        226.3941192626953
    ],
    "bwd_time_avg": 225.75947265625,
    "bwd_time_std": 1.1855654411181902,
    "bwd_time_pct": 31.73010952303399,
    "warmup_step_times": [
        262.17840576171875,
        247.79776000976562,
        247.7605743408203
    ],
    "step_times": [
        247.66848754882812,
        247.64956665039062,
        247.6505584716797,
        247.6409912109375,
        247.6541748046875
    ],
    "step_time_avg": 247.6527557373047,
    "step_time_std": 0.008976702938857054,
    "step_time_pct": 34.80726591832848,
    "total_communication_volume_in_bytes": 4289879040.0,
    "communication_throughputs_in_bytes_per_second": [
        31017350466.31027,
        32500154357.613293,
        32810245644.349545,
        32885102168.01888,
        32584077369.375515
    ],
    "avg_communication_throughput_in_gbps": 30.13702668355172,
    "std_communication_throughput_in_gbps": 0.6386202182675226
}
