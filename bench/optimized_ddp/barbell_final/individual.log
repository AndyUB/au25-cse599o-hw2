Arguments: Namespace(mode='individual', world_size=2, local_batch_size=4, context_length=128, verbose=True, ckpt_dir=None, bucket_size_mb=10)
Mode: individual
[Note] All-reduce communication is overlapped with the backward pass. The reported communication time is the non-overlapped portion.
=== Rank 0 Results ===
(Rank 0) Iteration times (ms): [621.127685546875, 622.1866455078125, 622.1695556640625, 622.2520751953125, 623.09375]
(Rank 0) Gradient communication times (ms): [18.203359603881836, 18.220256805419922, 18.240447998046875, 18.170047760009766, 18.152544021606445]
(Rank 0) Iteration time avg (std): 622.17 (0.62) ms
(Rank 0) Gradient communication time avg (std): 18.20 (0.03) ms
(Rank 0) Fraction of gradient communication time in an iteration: 2.92%
=== Rank 0 Extra Stats ===
{
    "warmup_iteration_times": [
        1127.778564453125,
        623.4954833984375,
        623.101806640625
    ],
    "warmup_communication_times": [
        17.144832611083984,
        18.152864456176758,
        18.143007278442383
    ],
    "warmup_zero_grad_times": [
        0.4407680034637451,
        1.1062079668045044,
        1.260864019393921
    ],
    "zero_grad_times": [
        1.107583999633789,
        1.1373759508132935,
        1.131775975227356,
        1.1615040302276611,
        1.1139839887619019
    ],
    "zero_grad_time_avg": 1.1304447889328002,
    "zero_grad_time_std": 0.019016115068103894,
    "zero_grad_time_pct": 0.1816946575126939,
    "warmup_fwd_times": [
        533.5090942382812,
        105.80989074707031,
        104.80470275878906
    ],
    "fwd_times": [
        104.36653137207031,
        104.45001220703125,
        104.75001525878906,
        105.25484466552734,
        104.88435363769531
    ],
    "fwd_time_avg": 104.74115142822265,
    "fwd_time_std": 0.3192392253249134,
    "fwd_time_pct": 16.834910027702605,
    "warmup_loss_times": [
        5.919424057006836,
        1.0383679866790771,
        1.0397440195083618
    ],
    "loss_times": [
        1.0382720232009888,
        1.0376640558242798,
        1.0394560098648071,
        1.0387519598007202,
        1.0383360385894775
    ],
    "loss_time_avg": 1.0384960174560547,
    "loss_time_std": 0.0005924556910781776,
    "loss_time_pct": 0.16691640631501756,
    "warmup_bwd_times": [
        308.6789855957031,
        249.84329223632812,
        250.37501525878906
    ],
    "bwd_times": [
        248.9357147216797,
        249.8423614501953,
        249.7433319091797,
        249.4605712890625,
        250.49087524414062
    ],
    "bwd_time_avg": 249.69457092285157,
    "bwd_time_std": 0.5077280391182458,
    "bwd_time_pct": 40.13307700062718,
    "warmup_bwd_plus_comm_times": [
        325.8238182067871,
        267.9961566925049,
        268.51802253723145
    ],
    "bwd_plus_comm_times": [
        267.1390743255615,
        268.06261825561523,
        267.98377990722656,
        267.63061904907227,
        268.64341926574707
    ],
    "bwd_plus_comm_time_avg": 267.8919021606445,
    "bwd_plus_comm_time_std": 0.49747001484097353,
    "bwd_plus_comm_time_pct": 43.057918142156694,
    "warmup_step_times": [
        262.0854187011719,
        247.54483032226562,
        247.47850036621094
    ],
    "step_times": [
        247.47622680664062,
        247.4989776611328,
        247.26454162597656,
        247.1663360595703,
        247.41366577148438
    ],
    "step_time_avg": 247.36394958496095,
    "step_time_std": 0.1282524875329683,
    "step_time_pct": 39.75856102288674,
    "total_communication_volume_in_bytes": 4289879040.0,
    "communication_throughputs_in_bytes_per_second": [
        235664137464.22888,
        235445585965.83026,
        235184960394.57724,
        236096189545.60715,
        236323847219.09402
    ],
    "avg_communication_throughput_in_gbps": 219.55272566328526,
    "std_communication_throughput_in_gbps": 0.3880853553216724
}
=== Rank 1 Results ===
(Rank 1) Iteration times (ms): [620.99658203125, 622.1168823242188, 622.4321899414062, 622.3359985351562, 622.8271484375]
(Rank 1) Gradient communication times (ms): [18.383615493774414, 18.325727462768555, 18.286592483520508, 18.210527420043945, 18.110944747924805]
(Rank 1) Iteration time avg (std): 622.14 (0.62) ms
(Rank 1) Gradient communication time avg (std): 18.26 (0.09) ms
(Rank 1) Fraction of gradient communication time in an iteration: 2.94%
=== Rank 1 Extra Stats ===
{
    "warmup_iteration_times": [
        1125.4031982421875,
        625.905029296875,
        623.1064453125
    ],
    "warmup_communication_times": [
        17.540000915527344,
        20.721664428710938,
        18.17647933959961
    ],
    "warmup_zero_grad_times": [
        0.6003199815750122,
        1.1032320261001587,
        1.6777280569076538
    ],
    "zero_grad_times": [
        1.265663981437683,
        1.1075520515441895,
        1.1500799655914307,
        1.1427839994430542,
        1.125920057296753
    ],
    "zero_grad_time_avg": 1.158400011062622,
    "zero_grad_time_std": 0.055604144989359026,
    "zero_grad_time_pct": 0.18620341534024373,
    "warmup_fwd_times": [
        531.710693359375,
        105.3946533203125,
        105.48223876953125
    ],
    "fwd_times": [
        103.17619323730469,
        104.69158172607422,
        104.59635162353516,
        105.39417266845703,
        105.61571502685547
    ],
    "fwd_time_avg": 104.6948028564453,
    "fwd_time_std": 0.8547602653202456,
    "fwd_time_pct": 16.828014991125926,
    "warmup_loss_times": [
        6.081920146942139,
        1.0384000539779663,
        1.037376046180725
    ],
    "loss_times": [
        1.0374399423599243,
        1.0378559827804565,
        1.0381439924240112,
        1.0382720232009888,
        1.0384000539779663
    ],
    "loss_time_avg": 1.0380223989486694,
    "loss_time_std": 0.00034254067803989843,
    "loss_time_pct": 0.1668467158498777,
    "warmup_bwd_times": [
        307.5335388183594,
        250.01583862304688,
        249.1458282470703
    ],
    "bwd_times": [
        249.64108276367188,
        249.50796508789062,
        249.87667846679688,
        249.0880584716797,
        249.48892211914062
    ],
    "bwd_time_avg": 249.52054138183593,
    "bwd_time_std": 0.2567345931266001,
    "bwd_time_pct": 40.106748672006454,
    "warmup_bwd_plus_comm_times": [
        325.0735397338867,
        270.7375030517578,
        267.3223075866699
    ],
    "bwd_plus_comm_times": [
        268.0246982574463,
        267.8336925506592,
        268.1632709503174,
        267.29858589172363,
        267.59986686706543
    ],
    "bwd_plus_comm_time_avg": 267.7840229034424,
    "bwd_plus_comm_time_std": 0.3078257036111664,
    "bwd_plus_comm_time_pct": 43.04234634426706,
    "warmup_step_times": [
        261.93670654296875,
        247.6312713623047,
        247.58682250976562
    ],
    "step_times": [
        247.49261474609375,
        247.44618225097656,
        247.48434448242188,
        247.46217346191406,
        247.447265625
    ],
    "step_time_avg": 247.46651611328124,
    "step_time_std": 0.018983652214921983,
    "step_time_pct": 39.776589182117704,
    "total_communication_volume_in_bytes": 4289879040.0,
    "communication_throughputs_in_bytes_per_second": [
        233353392397.30954,
        234090518300.87115,
        234591493405.12445,
        235571378085.3058,
        236866662656.65375
    ],
    "avg_communication_throughput_in_gbps": 218.7627264941604,
    "std_communication_throughput_in_gbps": 1.137647904529487
}
