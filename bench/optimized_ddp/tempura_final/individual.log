Arguments: Namespace(mode='individual', world_size=2, local_batch_size=4, context_length=128, verbose=True, ckpt_dir=None, bucket_size_mb=10)
=== Rank 1 Results ===
(Rank 1) Iteration times (ms): [963.9127807617188, 965.1102294921875, 966.7357177734375, 964.0076293945312, 965.3427124023438]
(Rank 1) Gradient communication times (ms): [38.93926239013672, 34.90879821777344, 42.2573127746582, 34.127872467041016, 34.18396759033203]
(Rank 1) Iteration time avg (std): 965.02 (1.03) ms
(Rank 1) Gradient communication time avg (std): 36.88 (3.22) ms
(Rank 1) Fraction of gradient communication time in an iteration: 3.82%
=== Rank 1 Extra Stats ===
{
    "warmup_iteration_times": [
        4630.94482421875,
        1439.4713134765625,
        955.6651611328125
    ],
    "warmup_communication_times": [
        41.06435012817383,
        37.93920135498047,
        34.502689361572266
    ],
    "warmup_zero_grad_times": [
        0.8294399976730347,
        1.1694719791412354,
        1.9851839542388916
    ],
    "zero_grad_times": [
        0.8085759878158569,
        0.9220799803733826,
        1.927135944366455,
        0.8289279937744141,
        1.0278719663619995
    ],
    "zero_grad_time_avg": 1.1029183745384217,
    "zero_grad_time_std": 0.4193750731672885,
    "zero_grad_time_pct": 0.11424718992773616,
    "warmup_fwd_times": [
        1760.8515625,
        110.55865478515625,
        111.97859191894531
    ],
    "fwd_times": [
        112.13772583007812,
        112.74649810791016,
        112.70553588867188,
        113.60307312011719,
        113.58560180664062
    ],
    "fwd_time_avg": 112.9556869506836,
    "fwd_time_std": 0.5641449279605204,
    "fwd_time_pct": 11.705001133670546,
    "warmup_loss_times": [
        5.283391952514648,
        1.1505600214004517,
        1.1689280271530151
    ],
    "loss_times": [
        1.1580159664154053,
        1.143936038017273,
        1.1527040004730225,
        1.1460800170898438,
        1.1617599725723267
    ],
    "loss_time_avg": 1.1524991989135742,
    "loss_time_std": 0.006793706145083249,
    "loss_time_pct": 0.1194273416874159,
    "warmup_bwd_times": [
        1535.5093994140625,
        548.1952514648438,
        539.3014526367188
    ],
    "bwd_times": [
        544.2000732421875,
        548.8151245117188,
        542.1377563476562,
        547.736328125,
        548.855224609375
    ],
    "bwd_time_avg": 546.3489013671875,
    "bwd_time_std": 2.7070304943815775,
    "bwd_time_pct": 56.61536295031709,
    "warmup_bwd_plus_comm_times": [
        1576.5737495422363,
        586.1344528198242,
        573.804141998291
    ],
    "bwd_plus_comm_times": [
        583.1393356323242,
        583.7239227294922,
        584.3950691223145,
        581.864200592041,
        583.039192199707
    ],
    "bwd_plus_comm_time_avg": 583.2323440551758,
    "bwd_plus_comm_time_std": 0.8380159803376127,
    "bwd_plus_comm_time_pct": 60.43721315554593,
    "warmup_step_times": [
        1287.4068603515625,
        740.458251953125,
        266.72833251953125
    ],
    "step_times": [
        266.66912841796875,
        266.5738220214844,
        266.5552978515625,
        266.5653381347656,
        266.5282897949219
    ],
    "step_time_avg": 266.5783752441406,
    "step_time_std": 0.047891449944514844,
    "step_time_pct": 27.62411219958177,
    "total_communication_volume_in_bytes": 4289879040.0,
    "communication_throughputs_in_bytes_per_second": [
        110168472042.92763,
        122888190342.1085,
        101518027492.09952,
        125700160305.71346,
        125493889164.96841
    ],
    "avg_communication_throughput_in_gbps": 109.10793009173452,
    "std_communication_throughput_in_gbps": 9.017518821531622
}
Mode: individual
[Note] All-reduce communication is overlapped with the backward pass. The reported communication time is the non-overlapped portion.
=== Rank 0 Results ===
(Rank 0) Iteration times (ms): [963.5241088867188, 965.1810913085938, 966.8554077148438, 963.9580688476562, 965.4237670898438]
(Rank 0) Gradient communication times (ms): [48.05615997314453, 34.28575897216797, 63.4508171081543, 34.179134368896484, 34.668609619140625]
(Rank 0) Iteration time avg (std): 964.99 (1.18) ms
(Rank 0) Gradient communication time avg (std): 42.93 (11.55) ms
(Rank 0) Fraction of gradient communication time in an iteration: 4.45%
=== Rank 0 Extra Stats ===
{
    "warmup_iteration_times": [
        4628.173828125,
        1327.1527099609375,
        1071.298583984375
    ],
    "warmup_communication_times": [
        32.35615921020508,
        47.58867263793945,
        271.442138671875
    ],
    "warmup_zero_grad_times": [
        0.6695039868354797,
        0.997376024723053,
        1.370144009590149
    ],
    "zero_grad_times": [
        0.8253440260887146,
        1.766975998878479,
        0.7154880166053772,
        0.8392639756202698,
        0.9816640019416809
    ],
    "zero_grad_time_avg": 1.0257472038269042,
    "zero_grad_time_std": 0.38014777300606606,
    "zero_grad_time_pct": 0.10629579167237282,
    "warmup_fwd_times": [
        1762.008056640625,
        109.1337890625,
        110.66556549072266
    ],
    "fwd_times": [
        111.1562271118164,
        111.12025451660156,
        106.6098861694336,
        111.51139068603516,
        111.77721405029297
    ],
    "fwd_time_avg": 110.43499450683593,
    "fwd_time_std": 1.9277652129742615,
    "fwd_time_pct": 11.444378662256705,
    "warmup_loss_times": [
        5.093376159667969,
        1.1604479551315308,
        1.138815999031067
    ],
    "loss_times": [
        1.1535359621047974,
        1.1517119407653809,
        1.1575360298156738,
        1.1448320150375366,
        1.161087989807129
    ],
    "loss_time_avg": 1.1537407875061034,
    "loss_time_std": 0.005511980502135363,
    "loss_time_pct": 0.11955981864456058,
    "warmup_bwd_times": [
        1543.4832763671875,
        543.4417114257812,
        419.91351318359375
    ],
    "bwd_times": [
        535.6649169921875,
        550.2152709960938,
        528.2921752929688,
        549.683837890625,
        550.1934204101562
    ],
    "bwd_time_avg": 542.8099243164063,
    "bwd_time_std": 9.147918104238462,
    "bwd_time_pct": 56.25089623410271,
    "warmup_bwd_plus_comm_times": [
        1575.8394355773926,
        591.0303840637207,
        691.3556518554688
    ],
    "bwd_plus_comm_times": [
        583.721076965332,
        584.5010299682617,
        591.742992401123,
        583.8629722595215,
        584.8620300292969
    ],
    "bwd_plus_comm_time_avg": 585.738020324707,
    "bwd_plus_comm_time_std": 3.0312063453288864,
    "bwd_plus_comm_time_pct": 60.69872258042675,
    "warmup_step_times": [
        1284.563232421875,
        624.8307495117188,
        266.76837158203125
    ],
    "step_times": [
        266.66796875,
        266.64111328125,
        266.6295166015625,
        266.599609375,
        266.64178466796875
    ],
    "step_time_avg": 266.63599853515626,
    "step_time_std": 0.022126549833509743,
    "step_time_pct": 27.631044452330134,
    "total_communication_volume_in_bytes": 4289879040.0,
    "communication_throughputs_in_bytes_per_second": [
        89268036447.30113,
        125121308922.52902,
        67609516086.88885,
        125511635072.4158,
        123739575573.62056
    ],
    "avg_communication_throughput_in_gbps": 98.95303698307933,
    "std_communication_throughput_in_gbps": 22.09609167044831
}
