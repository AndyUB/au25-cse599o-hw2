Args: Namespace(model='transformer', verbose=True, toy_ckpt_path='toy_model_ckpt.pt', transformer_world_size=2, transformer_global_batch_size=8, transformer_context_length=128, transformer_rope_theta=10000, transformer_warmup_steps=2, transformer_benchmark_steps=5, transformer_log_dir='../bench/naive_ddp_transformer/tempura')
329 broadcasts to sync 327 params and 2 buffers
=== Rank 0 Results ===
(Rank 0) Iteration times (ms): [1100.9566650390625, 1101.6151123046875, 1104.2393798828125, 1103.4794921875, 1103.6016845703125]
(Rank 0) Gradient communication times (ms): [487.7557678222656, 488.0485534667969, 487.0377197265625, 487.365966796875, 487.9073486328125]
(Rank 0) Iteration time avg (std): 1102.78 (1.26) ms
(Rank 0) Gradient communication time avg (std): 487.62 (0.37) ms
(Rank 0) Fraction of gradient communication time in an iteration: 44.22%
=== Rank 0 Extra Stats ===
{
    "total_communication_volume_in_bytes": 4289879040.0,
    "communication_throughputs_in_bytes_per_second": [
        8795137490.94854,
        8789861192.14438,
        8808104313.58061,
        8802171945.231337,
        8792405058.093235
    ],
    "avg_communication_throughput_in_gbps": 8.193343877792007,
    "std_communication_throughput_in_gbps": 0.006235875115241578,
    "warmup_iteration_times_in_ms": [
        5257.11767578125,
        1114.6502685546875
    ],
    "warmup_communication_times_in_ms": [
        487.0196533203125,
        487.41961669921875
    ]
}
=== Rank 1 Results ===
(Rank 1) Iteration times (ms): [1100.5545654296875, 1101.46337890625, 1104.24267578125, 1103.4876708984375, 1103.572998046875]
(Rank 1) Gradient communication times (ms): [486.2567443847656, 487.3564147949219, 487.4651794433594, 487.37005615234375, 486.74920654296875]
(Rank 1) Iteration time avg (std): 1102.66 (1.41) ms
(Rank 1) Gradient communication time avg (std): 487.04 (0.47) ms
(Rank 1) Fraction of gradient communication time in an iteration: 44.17%
=== Rank 1 Extra Stats ===
{
    "total_communication_volume_in_bytes": 4289879040.0,
    "communication_throughputs_in_bytes_per_second": [
        8822250980.657866,
        8802344464.482258,
        8800380459.787199,
        8802098089.21674,
        8813325183.348404
    ],
    "avg_communication_throughput_in_gbps": 8.203163589815137,
    "std_communication_throughput_in_gbps": 0.00786172171076976,
    "warmup_iteration_times_in_ms": [
        5258.623046875,
        1113.51904296875
    ],
    "warmup_communication_times_in_ms": [
        513.9679565429688,
        484.4540100097656
    ]
}
